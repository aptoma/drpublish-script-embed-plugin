<!DOCTYPE html>
<html>
<head>
    <script src="vendors/jquery/dist/jquery.min.js"></script>
    <script src="vendors/plugin-api/js/vendors/jquery.postmessage.js"></script>
    <script src="vendors/plugin-api/js/Listeners.js"></script>
    <script src="vendors/plugin-api/js/PluginAPI.js"></script>
    <script src="vendors/plugin-api/js/AH5Communicator.js"></script>
    <script src="vendors/plugin-api/js/ArticleCommunicator.js"></script>
    <title>Embed script plugin PoC</title>

    <script>
        $(document).ready(function () {
            PluginAPI.setAppName('embedscript');
        });

        function insertScript() {
            var embedCode = $('#embedcode').val();
            var embedCodePreview = embedCode.replace(/\</g, '&lt;').replace(/\>/g, '&gt;');
            var markup = '<div>'+ embedCodePreview+'</div>';
               var callback = function() {};
               var data = {
                   embeddedTypeId: 6,
                   assetType: 'script',
                   externalId: '',
                   assetClass: 'dp-script-asset',
                   assetSource: PluginAPI.getAppName(),
                   resourceUri: '',
                   previewUri: '',
                   options: {
                       code: embedCode,
                       foo: 'bar'
                  }
               }
               PluginAPI.Editor.insertEmbeddedAsset(markup, data, callback);
            }
    </script>

    <style>
        body {
            padding: 24px;
        }
    </style>

</head>
    <body>
    <br/>
    <textarea id="embedcode" style="width:300px; height: 200px">
alert('Hello World');
    </textarea>
    <br/>
    <a href="" onclick="insertScript(); return false">insert embedded script</a>
    <br/>

</body>


</html>
